% TODO change to POWER model instead of ENERGY model
\section{Energy model}
The total energy cost of a single partition consists of two components configuration and processing.

\begin{description}
    \item[Configuration energy ($\econf(p_i, \pi_i)$):]
    This accounts for the energy consumed in reading data from the external DDR memory and transferring it through the DDR PHY, DDR controller, AXI bus, and config NoC to the local SRAMs of the cores.
    The configuration energy for partition $p_i$ is influenced by the layers contained in the partition and the compiler parameters $\pi_i$.
    \begin{equation}
    \begin{split}
        \econf(p_i, \pi_i) = & \eddrread \times \readamount(p_i, \pi_i) + \\
                & \eddrphy \times \readamount(p_i, \pi_i) + \\
                & \eddrctrl \times \readamount(p_i, \pi_i) + \\
                & \eaxi \times \readamount(p_i, \pi_i) + \\
                & \enoc(p_i, \pi_i) + \\
                & \esramwrite \times \writeamount(p_i, \pi_i)
    \end{split}
    \end{equation}
    \eqexplSetIntro{where:}
    \eqexplSetItemWidth{6em}
    \begin{eqexpl}
        \item{$\eddrread$} energy per byte to read from external DDR memory.
        \item{$\eddrphy$} energy per byte consumed by the DDR PHY during data transfer.
        \item{$\eddrctrl$} energy per byte consumed by the DDR controller during data transfer.
        \item{$\eaxi$} energy per byte consumed by the AXI bus during data transfer.
        \item{$\enoc(p_i, \pi_i)$} energy consumed by the config NoC during the transfer of the data to their respective destination cores.
        The amount of data to be transferred to each core is influenced by the partition $p_i$ and compiler parameters $\pi_i$.
        \item{$\esramwrite$} energy per byte to write to a core's SRAM.
        \item{$\readamount(p_i, \pi_i)$} total bytes read from the external DDR memory for partition $p_i$ with compiler parameters $\pi_i$.
        \item{$\writeamount(p_i, \pi_i)$} total bytes written to the cores involved for partition $p_i$ with compiler parameters $\pi_i$.
    \end{eqexpl}

    \item[Processing energy ($\eproc(p_i, \pi_i)$):]
    This accounts for the energy consumed by the cores while executing the partition.
    Similarly, the processing energy for partition $p_i$ is influenced by the layers contained in the partition and the compiler parameters $\pi_i$.
    \begin{equation}
        % \eproc(p_i, \pi_i) = \latproc(p_i, \pi_i) \times \left| \cores(p_i, \pi_i) \right| \times \avgutil(p_i, \pi_i) \times \pcore
        \eproc(p_i, \pi_i) = \latproc(p_i, \pi_i) \times \lvert \coresused(p_i, \pi_i) \rvert \times \avgutil(p_i, \pi_i) \times \pcore
    \end{equation}
    \eqexplSetIntro{where:}
    \eqexplSetItemWidth{6em}
    \begin{eqexpl}
        \item{$\latproc(p_i, \pi_i)$} processing latency of partition $p_i$ with compiler parameters $\pi_i$.
        \item{$\coresused(p_i, \pi_i)$} set of cores used to execute partition $p_i$ with compiler parameters $\pi_i$.
        \item{$\avgutil(p_i, \pi_i)$} average utilization of the cores for partition $p_i$ with compiler parameters $\pi_i$.
        \item{$\pcore$} average processing power consumption of a single neuron core.
    \end{eqexpl}
\end{description}
The total energy consumption ($\etotal(p_i, \pi_i)$) for partition $p_i$ with compiler parameters $\pi_i$ is then:
\begin{equation}
    \etotal(p_i, \pi_i) = \econf(p_i, \pi_i) + \eproc(p_i, \pi_i)
\end{equation}
The total energy consumption for the complete partitioned model is the energy consumption of all individual partitions with their respective compiler parameters summed:
\begin{equation}
    \sum_{i=1}^{K} \etotal(p_i, \pi_i)
\end{equation}
